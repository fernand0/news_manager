# News Manager

A command-line interface (CLI) that uses the Gemini API to generate news articles from a text file or a URL.

## Configuration

### 1. API Key

This project uses the Google Gemini API. You need to provide your API key in an environment file.

1.  Create a file named `.env` in the root of the project.
2.  Add your API key to the file like this:

    ```
    GOOGLE_API_KEY="YOUR_API_KEY_HERE"
    ```

> **Note:** The `.env` file is included in `.gitignore` and should not be committed to your repository.

### 2. Input File Configuration (Opcional)

You can configure a default input file using an environment variable:

```bash
# En tu archivo .env
NEWS_INPUT_FILE="/ruta/a/tu/archivo/por/defecto.txt"
```

Or set it in your shell:
```bash
export NEWS_INPUT_FILE="/ruta/a/tu/archivo/por/defecto.txt"
```

### 3. Output Directory Configuration (Opcional)

You can configure a default output directory for saving generated files using an environment variable:

```bash
# En tu archivo .env
NEWS_OUTPUT_DIR="/ruta/a/tu/directorio/de/salida"
```

Or set it in your shell:
```bash
export NEWS_OUTPUT_DIR="/ruta/a/tu/directorio/de/salida"
```

When this variable is set, the generated news and Bluesky files will be automatically saved to this directory without needing to specify `--output-dir` each time.

## Installation

First, clone the repository and navigate into the project directory:

```bash
git clone https://github.com/fernand0/news_manager.git
cd news_manager
```

### 1. Create a Virtual Environment

It is highly recommended to use a virtual environment.

**Using `venv`:**
```bash
python -m venv .venv
source .venv/bin/activate
```

**Using `uv`:**
```bash
uv venv
source .venv/bin/activate
```

### 2. Install the CLI and Dependencies

Install the project in "editable" mode, which also installs all the necessary dependencies defined in `pyproject.toml`.

**Using `pip`:**
```bash
pip install -e .
```

**Using `uv`:**
```bash
uv pip install -e .
```

## Usage

### `generate`

Generates a news story by sending the content of an input file or a URL to the Gemini API.

**Opciones de entrada (exclusivas):**

- `--input-file` / `-i`: Archivo de texto local
- `--url`: URL de una noticia online

**Opciones de personalizaci√≥n:**

- `--prompt-extra`: Instrucciones adicionales para personalizar la generaci√≥n
- `--interactive-prompt`: Modo interactivo para a√±adir instrucciones personalizadas
- `--output-dir`: Directorio donde guardar los archivos generados (por defecto: usa NEWS_OUTPUT_DIR o no guarda archivos)

> **Nota:** No puedes usar ambas opciones de entrada al mismo tiempo. Si usas ambas, el comando mostrar√° un error.

**Ejemplos de uso:**

1. **Desde archivo local**
   ```bash
   news-manager generate --input-file ./mi_noticia.txt
   # o
   news-manager generate -i ./mi_noticia.txt
   ```

2. **Desde una URL**
   ```bash
   news-manager generate --url "https://www.bbc.com/mundo/noticias-xxxxxx"
   ```

3. **Archivo por defecto**
   ```bash
   news-manager generate
   # Usar√° /tmp/noticia.txt o el archivo configurado en NEWS_INPUT_FILE
   ```

4. **Con instrucciones personalizadas**
   ```bash
   # Centrarse en una persona espec√≠fica
   news-manager generate --url "https://ejemplo.com/noticia" --prompt-extra "c√©ntrate en Mar√≠a Santos e ignora el resto"
   
   # Enfocar en un aspecto particular
   news-manager generate -i noticia.txt --prompt-extra "enf√≥cate solo en los aspectos tecnol√≥gicos"
   
   # Cambiar el tono
   news-manager generate --url "https://ejemplo.com" --prompt-extra "usa un tono m√°s formal y acad√©mico"
   
   # Modo interactivo (se te preguntar√° qu√© instrucciones quieres)
   news-manager generate --url "https://ejemplo.com" --interactive-prompt
   ```

5. **Guardando archivos generados**
   ```bash
   # Especificar directorio de salida manualmente
   news-manager generate --url "https://ejemplo.com" --output-dir ./mis_noticias
   
   # Usar directorio configurado en NEWS_OUTPUT_DIR
   export NEWS_OUTPUT_DIR="/home/usuario/noticias"
   news-manager generate --url "https://ejemplo.com"
   # Los archivos se guardar√°n autom√°ticamente en /home/usuario/noticias
   ```

### Formato especial para tesis

Cuando la noticia generada corresponde a una tesis doctoral, el sistema produce:
- **T√≠tulo:** De la forma `Lectura de Tesis de [nombre] [primer apellido], "[t√≠tulo de la tesis]"`.
- **Slug/URL:** El archivo generado incluir√° el nombre y primer apellido del autor, seguido de palabras clave del t√≠tulo de la tesis.

**Ejemplo:**

- T√≠tulo generado:
  ```
  Lectura de Tesis de Nombre Apellido, "El t√≠tulo"
  ```
- Archivo generado:
  ```
  2025-07-15-nombre-apellido-el-titulo.txt
  ```

Esto facilita la identificaci√≥n y el acceso a las noticias de tesis, y mejora la legibilidad de los archivos y URLs.

**Opciones avanzadas:**
```bash
# Ver ayuda del comando
news-manager generate --help
```

**Example Output:**

The output will be the formatted news article generated by the Gemini API.
```
--- Inicializando cliente AI y generando noticia... ---
T√≠tulo: Descubren nueva especie de mariposa luminiscente en el Amazonas los doctores Alistair Finch y Elena Vance
Texto: El Dr. Alistair Finch, un bi√≥logo de la Universidad de Greendale, junto a la Dra. Elena Vance, ha anunciado el descubrimiento de una nueva especie de mariposa que brilla en la oscuridad en la selva amaz√≥nica. Este hallazgo ha sido publicado en un reciente estudio cient√≠fico.

La investigaci√≥n detalla las caracter√≠sticas √∫nicas de este insecto, que utiliza la bioluminiscencia como un posible mecanismo de defensa y comunicaci√≥n. El Dr. Finch ha dedicado m√°s de una d√©cada al estudio de la entomolog√≠a en la regi√≥n, mientras que la Dra. Vance es una experta en gen√©tica de insectos. La Universidad de Greendale ha financiado gran parte de esta expedici√≥n.
Enlaces:
- https://ejemplo.com/noticia-original
Bluesky: Descubierta una nueva especie de mariposa luminiscente en el Amazonas por los doctores Alistair Finch y Elena Vance. Este incre√≠ble hallazgo abre nuevas puertas a la investigaci√≥n de la bioluminiscencia. #ciencia #naturaleza #descubrimiento [enlace a la noticia]
```

### `hello`

Prints a welcome message to confirm that the `news-manager` CLI is correctly installed and accessible in your environment.

**How to run:**
```bash
news-manager hello
```

**Example Output:**
```
Welcome to News Manager CLI!
This tool helps you generate and manage news content using the Gemini API.
Try 'news-manager generate' to create a news story or 'news-manager --help' for more commands.
```

---

## About This Project

This project was developed using a collaborative approach with AI tools:

- **[Google Gemini AI](https://developers.google.com/gemini/ai-hub/docs/cli)**: Used for the AI-powered news generation functionality and initial development
- **[Cursor](https://cursor.sh/)**: The world's best AI-powered code editor was used for pair programming, code generation, and iterative development

The development process involved a conversational flow to build, refactor, and enhance the application step by step, leveraging the strengths of both tools for optimal code quality and functionality.

## üåê Website

Visit our beautiful website to learn more about News Manager:

**[üì∞ News Manager Website](https://fernand0.github.io/news_manager/)**

The website features:
- ‚ú® Modern, responsive design
- üì± Mobile-friendly interface
- üöÄ Interactive examples
- üìä Live demonstrations
- üõ†Ô∏è Complete documentation

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Publicar en Bluesky

El proyecto incluye un CLI auxiliar para publicar posts en Bluesky a partir de los archivos generados por News Manager.

### Estructura del proyecto

- `news_manager/`: Paquete principal para generaci√≥n de noticias y CLI principal.
- `news_publisher/`: Herramientas auxiliares para publicaci√≥n en Bluesky (CLI propio).

### Configuraci√≥n

1. **Directorio de b√∫squeda de posts**
   - Por defecto, el CLI busca archivos `*_blsky.txt` en el directorio configurado en la variable `BLUESKY_POSTS_DIR` de tu `.env`:
     ```
     BLUESKY_POSTS_DIR=/ruta/a/tu/directorio
     ```
   - Si no est√° definida, usar√° el directorio actual.
   - Puedes sobrescribirlo con el argumento `--dir`.

2. **Usuario de Bluesky**
   - Por defecto, se usa el √∫ltimo perfil definido en `~/.mySocial/config/.rssBlsk`.
   - Puedes sobrescribirlo con el argumento `--user`.

### Uso

Para publicar el √∫ltimo post generado en Bluesky, puedes usar `uv run` o ejecutar el m√≥dulo directamente:

**Usando `uv run`:**
```bash
uv run news_publisher publish
```

**Ejecutando el m√≥dulo:**
```bash
python -m news_publisher publish
```

Opciones:
- `--dir /ruta/a/archivos` para especificar el directorio de b√∫squeda.
- `--user tu_usuario_bluesky` para especificar el usuario de Bluesky.

**Ejemplo:**
```bash
uv run news_publisher publish --dir /home/usuario/noticias --user miusuario
```

El CLI mostrar√° el contenido a publicar y pedir√° confirmaci√≥n antes de enviarlo a Bluesky.

### Requisitos
- Tener configurado el archivo `.env` con la variable `BLUESKY_POSTS_DIR` si quieres un directorio por defecto.
- Tener configurado el archivo `~/.mySocial/config/.rssBlsk` con tus credenciales de Bluesky.
- Las dependencias se gestionan autom√°ticamente desde `pyproject.toml`.

Para convenciones espec√≠ficas sobre el formato de t√≠tulos, slugs y reglas especiales (por ejemplo, para tesis doctorales), consulta el archivo [CONVENCIONES.md](CONVENCIONES.md).
